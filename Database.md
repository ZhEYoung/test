# **表结构设计**

## **用户与角色基础数据**

### **1. 用户表(user)**

- **主键**：`用户ID` (`user_id`)

- **关系**：存储所有用户的公共信息，作为所有用户的基础表，供学生表、教师表和管理员表进行扩展。

- **表结构**：

  | 字段                      | 数据类型       | 约束         | 索引 | 说明                        |
  | ------------------------- | -------------- | ------------ | ---- | --------------------------- |
  | 用户ID (`user_id`)        | `INT`          | 主键         | 索引 | 唯一标识每个用户            |
  | 用户名 (`username`)       | `VARCHAR(10)`  | 唯一         | 索引 | 用户的登录用户名            |
  | 密码 (`password`)         | `VARCHAR(255)` | 非空         |      | 用户的密码                  |
  | 角色 (`role`)             | `INT`          | 非空         |      | 0: 管理员；1: 教师；2: 学生 |
  | 账号状态 (`status`)       | `BOOLEAN`      | 默认 1       |      | 账号是否有效                |
  | 性别(`sex`)               | `BOOLEAN`      |              |      | 0: 女；1: 男                |
  | 联系方式 (`phone`)        | `VARCHAR(20)`  |              |      | 用户的电话号码              |
  | 邮箱 (`email`)            | `VARCHAR(50)`  | 唯一         |      | 用户的电子邮箱              |
  | 注册时间 (`created_time`) | `TIMESTAMP`    | 默认当前时间 |      | 账号创建时间                |

### **2.管理员表(admin)**

- **主键**：`管理员ID` (`admin_id`)

- **关系**：一个管理员可以创建多个教师账号(`1 : N`)，一个管理员可以模拟多个教师账号(`1 : N`)

- **表结构**：

  | 字段                  | 数据类型       | 约束 | 索引 | 说明                  |
  | --------------------- | -------------- | ---- | ---- | --------------------- |
  | 管理员ID (`admin_id`) | `INT`          | 主键 | 索引 | 唯一标识每个管理员    |
  | 用户ID (`user_id`)    | `INT`          | 外键 | 索引 | 关联 `users` 表的主键 |
  | 姓名 (`name`)         | `VARCHAR(20)`  | 非空 |      | 管理员姓名            |
  | 备注 (`other`)        | `VARCHAR(100)` |      |      | 备注信息              |

### **3.教师表(teacher)**

- **主键**：`教师ID` (`teacher_id`)

- **关系**：一个教师可以管理多个班级(`1 : N`)，一个教师监考多个学生(`1 : N`)，一个教师可以管理多个题库，一个题库可以被多个教师访问(`N : M`)，一个教师可以创建多份试卷(`1 : N`)，一个教师可以批改多份试卷(`1 : N`)，一个教师可以修改多道题目(`1 : N`)

- **表结构**：

  | 字段                    | 数据类型       | 约束 | 索引 | 说明                                                         |
  | ----------------------- | -------------- | ---- | ---- | ------------------------------------------------------------ |
  | 教师ID (`teacher_id`)   | `INT`          | 主键 | 索引 | 唯一标识每个教师                                             |
  | 用户ID (`user_id`)      | `INT`          | 外键 | 索引 | 关联 `users` 表的主键                                        |
  | 姓名 (`name`)           | `VARCHAR(20)`  | 非空 |      | 教师姓名                                                     |
  | 权限(`permission`)      | `INT`          |      |      | 0: 可以组卷与发布所有考试；1是可以组卷与发布普通考试；2是可以组卷 |
  | 学院编号 (`college_id`) | `INT`          | 外键 | 索引 | 关联 `college` 表的主键                                      |
  | 备注 (`other`)          | `VARCHAR(100)` |      |      | 备注信息                                                     |

### **4.学生表(student)**

- **主键**：`学生ID` (`student_id`)

- **关系**：每个学生可以属于多个班级，每个班级拥有多个学生 (`N : M`)，每个学生可以加入多个班级(`1 : N`)

- **表结构**：

  | 字段                    | 数据类型       | 约束 | 索引 | 说明                      |
  | ----------------------- | -------------- | ---- | ---- | ------------------------- |
  | 学生ID (`student_id`)   | `INT`          | 主键 | 索引 | 唯一标识每个学生          |
  | 用户ID (`user_id`)      | `INT`          | 外键 | 索引 | 关联 `users` 表的主键     |
  | 姓名 (`name`)           | `VARCHAR(20)`  | 非空 |      | 学生姓名                  |
  | 年级 (`grade`)          | `VARCHAR(10)`  | 非空 |      | 学生所在年级，例如 "2024" |
  | 学院编号 (`college_id`) | `INT`          | 外键 | 索引 | 关联 `college` 表的主键   |
  | 备注 (`other`)          | `VARCHAR(100)` |      |      | 备注信息                  |

## 

## **组织结构与课程**

### **5.学院表(college)**

- **主键**：`学院ID` (`college_id`)

- **表结构**

  | 字段                      | 数据类型       | 约束         | 索引 | 说明                        |
  | ------------------------- | -------------- | ------------ | ---- | --------------------------- |
  | 学院编号 (`college_id`)   | `INT`          | 主键         | 索引 | 唯一标识每个学院            |
  | 学院名称 (`college_name`) | `VARCHAR(50)`  | 非空         | 唯一 | 学院名称，例如 "计算机学院" |
  | 学院描述 (`description`)  | `VARCHAR(255)` | 可为空       |      | 学院的详细描述              |
  | 创建时间 (`created_time`) | `TIMESTAMP`    | 默认当前时间 |      | 学院记录创建时间            |

### **6.学科表(subject)**

- **主键**：`学科ID` (`subject_id`)

- **关系**：一个学科可以开多个班级(`1 : N`）。一个学科可以创建多个题库(`1 : N`)。一个学科可以创建多份试卷(`1 : N`)。

- **表结构**

  | 字段                     | 数据类型       | 约束   | 索引 | 说明                    |
  | ------------------------ | -------------- | ------ | ---- | ----------------------- |
  | 学科ID (`subject_id`)    | `INT`          | 主键   | 索引 | 唯一标识每个学科        |
  | 学科名称(`subject_name`) | `VARCHAR(50)`  | 唯一   | 索引 | 学科的名称，如数学      |
  | 学科描述(`description`)  | `VARCHAR(255)` | 可为空 |      | 学科的详细描述          |
  | 学院编号 (`college_id`)  | `INT`          | 外键   | 索引 | 关联 `college` 表的主键 |

### **7.班级表(class)**

- **主键**：`班级ID` (`ClassID`)

- **关系**：一个教师可以管理多个班级(`1 : N`)，一个学生可以加入多个班级(`1 : N`)

- **表结构**：

  | 字段                   | 数据类型       | 约束    | 索引 | 说明                                               |
  | ---------------------- | -------------- | ------- | ---- | -------------------------------------------------- |
  | 班级ID(`class_id`)     | `INT`          | 主键    | 索引 | 唯一标识每个班级                                   |
  | 教师ID(`teacher_id`)   | `INT`          | 外键    | 索引 | 管理`教师表`的`teacher_id`                         |
  | 课程名(`class_name`)   | `VARCHAR(100)` |         |      | 课程的名字                                         |
  | 学科编号(`subject_id`) | `INT`          | 外键    | 索引 | 班级的学科编号                                     |
  | 期末考试(`final_exam`) | `BOOLEAN`      | 默认为0 |      | 0: 不存在已发布的期末考试；1: 存在已发布的期末考试 |

### **8.学生-班级关联表(student_class)**

- **主键**：`关联ID`(`sc_id`)

- **关系**：多对多关系，连接学生和班级

- **表结构**：

  | 字段                   | 数据类型    | 约束         | 索引 | 说明                           |
  | ---------------------- | ----------- | ------------ | ---- | ------------------------------ |
  | 关联ID (`sc_id`)       | `INT`       | 主键         | 索引 | 唯一标识每份关联               |
  | 学生ID (`student_id`)  | `INT`       | 外键         | 索引 | 关联 `学生表` 的 `student_id`  |
  | 班级ID (`class_id`)    | `INT`       | 外键         | 索引 | 关联 `班级表` 的 `class_id`    |
  | 状态 (`status`)        | `BOOLEAN`   | 默认 1       |      | 0: 不在当前班级；1: 在当前班级 |
  | 加入时间 (`join_time`) | `TIMESTAMP` | 默认当前时间 |      | 学生加入班级的时间             |
  | 退出时间 (`left_time`) | `TIMESTAMP` | 可为空       |      | 学生退出班级的时间             |

## 

## **考试相关**

### **9.考试表(exam)**

- **主键**：`考试ID` (`exam_id`)

- **表结构**

  | 字段                            | 数据类型       | 约束           | 索引 | 说明                             |
  | ------------------------------- | -------------- | -------------- | ---- | -------------------------------- |
  | 考试ID (`exam_id`)              | `INT`          | 主键           | 索引 | 唯一标识每场考试                 |
  | 考试名称 (`exam_name`)          | `VARCHAR(100)` | 非空           | 索引 | 考试的名称                       |
  | 学科编号 (`subject_id`)         | `INT`          | 外键           | 索引 | 关联 `subject` 的 `subject_id`   |
  | 试卷编号 (`paper_id`)           | `INT`          | 外键           | 索引 | 关联`exam_paper`的`paper_id`     |
  | 考试开始时间(`exam_start_time`) | `TIMESTAMP`    | 非空，单位分钟 |      | 考试开始的时间                   |
  | 考试结束时间(`exam_end_time`)   | `TIMESTAMP`    | 非空，单位分钟 |      | 由考试开始时间和考试时长计算得到 |
  | 考试时长 (`exam_duration`)      | `INT`          | 非空，单位分钟 |      | 考试时长                         |
  | 创建时间 (`created_time`)       | `TIMESTAMP`    | 默认当前时间   |      | 考试记录创建时间                 |
  | 监考教师ID(`teacher_id`)        | `INT`          | 外键           | 索引 | 监考教师ID                       |
  | 考试状态(`exam_status`)         | `INT`          |                |      | 0: 未开始；1: 进行中；2: 已结束  |
  | 考试类型(`exam_type`)           | `INT`          |                |      | 0: 正常考试；1: 重考             |

### **10.试卷表(exam_paper)**

- **主键**：`试卷ID` (`paper_id`)

- **关系**：每张试卷由教师创建 `(N : 1)`，每张试卷由教师批改(`N : 1`)，一张试卷包含多道题目，一道题目可以用于多份试卷(`N : M`)

- **表结构**

  | 字段                          | 数据类型        | 约束                           | 索引 | 说明                 |
  | ----------------------------- | --------------- | ------------------------------ | ---- | -------------------- |
  | 试卷ID (`paper_id`)           | `INT`           | 主键                           | 索引 | 唯一标识每张试卷     |
  | 试卷名称 (`paper_name`)       | `VARCHAR(50)`   | 唯一                           | 索引 | 试卷的名称           |
  | 试卷状态 (`paper_status`)     | `INT`           |                                |      | 0: 未发布，1: 已发布 |
  | 学科编号 (`subject_id`)       | `INT`           | 外键                           | 索引 | 试卷的学科编号       |
  | 创建教师ID (`teacher_id`)     | `INT`           | 外键                           | 索引 | 创建试卷的教师ID     |
  | 创建时间 (`created_time`)     | `DATETIME`      | 默认当前时间                   |      | 试卷创建的时间       |
  | 试卷类型 (`exam_type`)        | `INT`           |                                | 索引 | 0: 期末，1: 普通考试 |
  | 学年学期 (`academic_term`)    | `DATETIME`      | 只保留年月，月只允许1:上和6:下 |      | 试卷所属的学期       |
  | 试卷难度 (`paper_difficulty`) | `DECIMAL(5, 2)` |                                |      | 试卷难度             |

### **11.试卷-题目关联表 (exam_paper_question)**

- **主键**：`关联ID`(`epq_id`)

- **关系**：多对多关系，连接试卷和题目

- **表结构**

  | 字段                       | 数据类型        | 约束 | 索引 | 说明                        |
  | -------------------------- | --------------- | ---- | ---- | --------------------------- |
  | ID(`epq_id`)               | `INT`           | 主键 | 索引 | 唯一标识每份关联            |
  | 试卷ID (`paper_id`)        | `INT`           | 外键 | 索引 | 关联`试卷表`的`paper_id`    |
  | 题目ID (`question_id`)     | `INT`           | 外键 | 索引 | 关联`题目表`的`question_id` |
  | 题目顺序(`question_order`) | `INT`           |      |      | 记录题目的顺序              |
  | 题目分值(`question_score`) | `DECIMAL(5, 2)` |      |      | 记录题目的分值              |

### **12.考试-班级关联表 (exam_class)**

- **主键**：`关联ID` (`ec_id`)

- **表结构**

  | 字段                     | 数据类型    | 约束         | 索引 | 说明                      |
  | ------------------------ | ----------- | ------------ | ---- | ------------------------- |
  | 记录ID (`ec_id`)         | `INT`       | 主键         | 索引 | 唯一标识每条记录          |
  | 考试ID (`exam_id`)       | `INT`       | 外键         | 索引 | 关联 `exam` 的 `exam_id`  |
  | 班级ID (`class_id`)      | `INT`       | 外键         | 索引 | 关联 `class` 的`class_id` |
  | 创建时间 (`create_time`) | `TIMESTAMP` | 默认当前时间 |      | 记录创建时间              |

### **13.考试-学生关联表(exam_student)**

- **主键**：`关联ID` (`es_id`)

- **表结构**

  | 字段                             | 数据类型       | 约束           | 索引 | 说明                          |
  | -------------------------------- | -------------- | -------------- | ---- | ----------------------------- |
  | ID (`es_id`)                     | `INT`          | 主键           | 索引 | 唯一标识每条记录              |
  | 考试ID (`exam_id`)               | `INT`          | 外键           | 索引 | 关联 `考试表` 的 `exam_id`    |
  | 学生ID (`student_id`)            | `INT`          | 外键           | 索引 | 关联 `学生表` 的 `student_id` |
  | 参加时间 (`student_start_time`)  | `TIMESTAMP`    | 可为空         |      | 学生开始考试的时间            |
  | 提交时间 (`student_submit_time`) | `TIMESTAMP`    | 可为空         |      | 学生提交考试的时间            |
  | 缺考标记 (`absent`)              | `BOOLEAN`      | 默认为 `FALSE` |      | 标记学生是否缺考              |
  | 是否需要重考 (`retake_needed`)   | `BOOLEAN`      | 默认为 `FALSE` |      | 标记学生是否需要重考          |
  | 违纪标记 (`disciplinary`)        | `BOOLEAN`      | 默认为`FALSE`  |      | 标记学生是否违纪              |
  | 教师评语 (`teacher_comment`)     | `VARCHAR(100)` |                |      | 教师对学生评语                |

## 

## **题库与题目**

### **14.题库表(question_bank)**

- **主键**：`题库ID` (`qb_id`)

- **关系**：一个教师可以管理多个题库，一个题库可以被多个教师访问(`N : M`)，一个题库拥有多道题目(`1 : N`)

- **表结构**：

  | 字段                   | 数据类型      | 约束 | 索引 | 说明             |
  | ---------------------- | ------------- | ---- | ---- | ---------------- |
  | 题库ID (`qb_id`)       | `INT`         | 主键 | 索引 | 唯一标识每个题库 |
  | 题库名称(`qb_name`)    | `VARCHAR(20)` | 唯一 |      | 题库的名称       |
  | 学科编号(`subject_id`) | `INT`         | 外键 | 索引 | 题库的学科编号   |

### **15.题目表(question)**

- **主键**：`题目ID` (`question_id`)

- **关系**：一个题目属于一个题库 `(N : 1)`，每个题目被教师编写(`1 : N`)，一张试卷包含多道题目，一道题目可以用于多份试卷(`N : M`)

- **表结构**：

  | 字段                   | 数据类型        | 约束 | 索引 | 说明                                        |
  | ---------------------- | --------------- | ---- | ---- | ------------------------------------------- |
  | 题目ID (`question_id`) | `INT`           | 主键 | 索引 | 唯一标识每个题目                            |
  | 题库ID (`qb_id`)       | `INT`           | 外键 | 索引 | 关联`question_bank`的`qb_id`                |
  | 内容 (`content`)       | `TEXT`          | 唯一 |      | 题目的详细内容                              |
  | 答案(`answer`)         | `VARCHAR(255)`  |      |      | 题目的答案                                  |
  | 题目类型(`type`)       | `INT`           |      |      | 0: 单选；1: 多选；2: 判断；3: 填空；4: 简答 |
  | 题目难度(`difficulty`) | `DECIMAL(5, 2)` |      |      | 题目的难度系数                              |

### **16.题目选项表(question_option)**

- **主键**：`选项ID` (`id`)

- **表结构**

  | 字段                    | 数据类型       | 约束  | 索引 | 说明                                         |
  | ----------------------- | -------------- | ----- | ---- | -------------------------------------------- |
  | 选项ID (`option_id`)    | `INT`          | 主键  | 索引 | 唯一标识每个选项                             |
  | 题目ID (`question_id`)  | `INT`          | 外键  | 索引 | 关联 `题目表` 的 `题目ID`                    |
  | 选项内容 (`content`)    | `VARCHAR(255)` | 非空  |      | 选项的具体内容，例如 `A: 选项内容`           |
  | 是否正确 (`is_correct`) | `BOOLEAN`      | 默认0 |      | 0：错误选项，1：正确选项，适用于单选和多选题 |

## 

## **学生成绩**

### **17.学生成绩表(student_score)**

- **主键**：`成绩ID` (`score_id`)

- **关系**：一个学生拥有多份考试成绩(`1 : N`)

- **表结构**：

  | 字段                        | 数据类型        | 约束 | 索引 | 说明                        |
  | --------------------------- | --------------- | ---- | ---- | --------------------------- |
  | 成绩ID(`score_id`)          | `INT`           | 主键 | 索引 | 唯一标识每份成绩            |
  | 学生ID (`student_id`)       | `INT`           | 外键 | 索引 | 管理`student`的`student_id` |
  | 考试ID(`exam_id`)           | `INT`           | 外键 | 索引 | 管理`exam`的`test_id`       |
  | 成绩(`score`)               | `DECIMAL(5, 2)` |      |      | 考试成绩                    |
  | 成绩上传时间(`upload_time`) | `TIMESTAMP`     |      |      | 成绩的上传时间              |

### **18.学生题目成绩表 (student_question_score)**

- **主键**：`记录ID` (`record_id`)

- **表结构**

  | 字段                   | 数据类型        | 约束      | 索引 | 说明                             |
  | ---------------------- | --------------- | --------- | ---- | -------------------------------- |
  | 记录ID (`record_id`)   | `INT`           | 主键      | 索引 | 唯一标识每条记录                 |
  | 考试ID (`exam_id`)     | `INT`           | 外键      | 索引 | 关联 `exam` 的 `exam_id`         |
  | 学生ID (`student_id`)  | `INT`           | 外键      | 索引 | 关联 `student` 的 `student_id`   |
  | 题目ID (`question_id`) | `INT`           | 外键      | 索引 | 关联 `question` 的 `question_id` |
  | 成绩ID (`score_id`)    | `INT`           | 外键      | 索引 | 关联`score`的`score_id`          |
  | 学生答案 (`answer`)    | `TEXT`          | 可为空    |      | 存储学生的作答                   |
  | 得分 (`score`)         | `DECIMAL(5, 2)` | 默认 0.00 |      | 教师为该题目评定的分数           |
  | 批改状态 (`status`)    | `INT`           | 默认'0'   |      | 0: 未批改；1: 未批改             |

## 

## **日志与扩展**

### **19.日志表 (log)**

- **主键**：`日志ID` (`log_id`)

- **表结构**

  | 字段                           | 数据类型      | 约束 | 索引 | 说明                                                         |
  | ------------------------------ | ------------- | ---- | ---- | ------------------------------------------------------------ |
  | 日志ID (`log_id`)              | `INT`         | 主键 | 索引 | 唯一标识每条日志                                             |
  | 用户ID (`user_id`)             | `INT`         | 外键 | 索引 | 关联 `user` 的 `user_id`                                     |
  | 操作类型(`action_type`)        | `INT`         |      |      | 0: `INSERT`、1: `UPDATE`、2: `DELETE`、3: `LOGIN`、4: `SUBMIT_TEST`、5：`EXCEPTION`、6：`SIMULATE_LOGIN` 7：`SELECT` 8：`EXPORT` |
  | 操作描述(`action_description`) | `TEXT`        |      |      | 操作的详细描述                                               |
  | 操作时间(`created_time`)       | `TIMESTAMP`   |      |      | 操作发生的时间                                               |
  | 操作对象(`object_type`)        | `TEXT`        |      |      | 操作对象的类型                                               |
  | IP地址(`ip_address`)           | `VARCHAR(50)` |      |      | 操作对象的IP地址                                             |
  | 设备信息(`device_info`)        | `TEXT`        |      |      | 操作对象的设备信息                                           |
  | 操作状态(`status`)             | `VARCHAR(20)` |      |      | 操作对象的状态                                               |

